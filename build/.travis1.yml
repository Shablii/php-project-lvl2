language: "php"

php:
  - 8.0.1

before_script: 
- composer update
- composer install

script:
- XDEBUG_MODE=coverage composer exec --verbose phpunit tests -- --coverage-text
- XDEBUG_MODE=coverage composer exec --verbose phpunit tests -- --coverage-clover build/logs/clover.xml


after_script:
- CODECLIMATE_REPO_TOKEN="8e34ef604009610b850cfc6a372c2b7debd459e7262e843cc4e3722120f5359e" vendor/bin/test-reporter --stdout > codeclimate.json
- "sh -c 'if [ \"$TRAVIS_PHP_VERSION\" != \"hhvm\" ]; then curl -X POST -d @codeclimate.json -H \"Content-Type: application/json\" -H \"User-Agent: Code Climate (PHP Test Reporter v0.1.1)\" https://codeclimate.com/test_reports  ; fi'"